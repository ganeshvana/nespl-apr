<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="report_saleorder_document11">
		<t t-call="web.basic_layout">
			<t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />

			<div class="page">
				<table style="border-style: solid;border-width:1px;" width="100%">
					<tr>
						<td width="80%">
							<center><strong><h3>BILL OF MATERIAL</h3></strong></center>
						</td>
						<td><img t-att-src="image_data_uri(doc.company_id.logo)"
								style="max-height: 4cm; max-width: 4cm;" align="right" /></td>
					</tr>
				</table>
				<table style="border-style: solid;border-width:1px;" width="100%">
					<tr>
						<td width="50%">
						<t t-set="address">
							<div t-field="doc.sale_order_id.partner_id"
								t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />
							<p t-if="doc.sale_order_id.partner_id.vat">
								<t
									t-esc="doc.sale_order_id.company_id.account_fiscal_country_id.vat_label or 'Tax ID'" />
								:
								<span t-field="doc.sale_order_id.partner_id.vat" />
							</p>
						</t>
						<t
							t-if="doc.sale_order_id.partner_shipping_id == doc.sale_order_id.partner_invoice_id
                             and doc.sale_order_id.partner_invoice_id != doc.sale_order_id.partner_id
                             or doc.sale_order_id.partner_shipping_id != doc.sale_order_id.partner_invoice_id">
							<t t-set="information_block">
								<strong
									t-if="doc.sale_order_id.partner_shipping_id == doc.sale_order_id.partner_invoice_id">Invoicing and Shipping Address:</strong>
								<strong
									t-if="doc.sale_order_id.partner_shipping_id != doc.sale_order_id.partner_invoice_id">Invoicing Address:</strong>
								<div t-field="doc.sale_order_id.partner_invoice_id"
									t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}' />
								<t t-if="doc.sale_order_id.partner_shipping_id != doc.sale_order_id.partner_invoice_id">
									<strong>Shipping Address:</strong>
									<div t-field="doc.sale_order_id.partner_shipping_id"
										t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}' />
								</t>
							</t>
						</t>
					</td>
					<td width="50%">
						<t t-set="address">
							<div t-field="doc.company_id.partner_id"
								t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />
							<p t-if="doc.company_id.partner_id.vat">
								<t
									t-esc="doc.company_id.account_fiscal_country_id.vat_label or 'Tax ID'" />
								:
								<span t-field="doc.company_id.partner_id.vat" />
							</p>
						</t>
					</td>
					</tr>
				</table>
				<div class="oe_structure" />

				

				<table style="border-style: solid;border-width:1px;">
					<!-- In case we want to repeat the header, remove "display: table-row-group" -->
					<thead style="display: table-row-group">
						<tr style="border-style: solid;border-width:1px;">
							<th name="th_description" class="text-left">S. No</th>
							<th name="th_description" class="text-left">Item Description</th>
							<th name="th_description" class="text-left">Item Code / Make</th>
							<th name="th_quantity" class="text-right">Quantity</th>
							<th name="th_quantity" class="text-right">Unit</th>
							<th name="th_subtotal" class="text-right">
								<span>Amount</span>
							</th>
						</tr>
					</thead>
					<tbody class="sale_tbody">
						<t t-set="i" t-value="0" />
						<t t-set="current_subtotal" t-value="0" />

						<t t-foreach="doc.sale_order_template_line_ids" t-as="line">

							<t t-set="current_subtotal" t-value="current_subtotal + line.total" />
							
							

							<tr style="border-style: solid;border-width:1px;"
								t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
								<t t-if="not line.display_type">
									<t t-set="i" t-value="i + 1" />
									<td style="border-style: solid;border-width:1px;" name="td_name">
										<span t-esc="i" />
									</td>
									<td style="border-style: solid;border-width:1px;" name="td_name">
										<span t-field="line.name" />
									</td>
									<td style="border-style: solid;border-width:1px;" name="td_name">
										<t t-if="line.vendor_ids">
										<t t-foreach="line.vendor_ids" t-as="l">
											<span t-field="l.name" /> /
										</t>
										<span t-field="line.model" />
									</t>
									</td>
									<td style="border-style: solid;border-width:1px;" name="td_quantity" class="text-right">
										<span t-field="line.product_uom_qty" />
										
									</td>
									<td style="border-style: solid;border-width:1px;" name="td_priceunit" class="text-right">
										<span t-field="line.product_uom_id" />
									</td>
									
									<td style="border-style: solid;border-width:1px;" name="td_subtotal" class="text-right o_price_total">
										<span t-field="line.total" />
									</td>
								</t>
								<t t-if="line.display_type == 'line_section'">
									<td style="border-style: solid;border-width:1px;" name="td_section_line" colspan="99">
										<span t-field="line.name" />
									</td>
									<t t-set="current_section" t-value="line" />
									<t t-set="current_subtotal" t-value="0" />
								</t>
								<t t-if="line.display_type == 'line_note'">
									<td style="border-style: solid;border-width:1px;" name="td_note_line" colspan="99">
										<span t-field="line.name" />
									</td>
								</t>
							</tr>

							<t t-if="current_section and (line_last or doc.sale_order_template_line_ids[line_index+1].display_type == 'line_section')">
								<tr class="is-subtotal text-right">
									<td style="border-style: solid;border-width:1px;" name="td_section_subtotal" colspan="99">
										<strong class="mr16">Subtotal</strong>
										<span t-esc="current_subtotal"
											t-options='{"widget": "monetary", "display_currency": doc.sale_order_id.currency_id}' />
									</td>
								</tr>
								<tr>
									<td style="border-style: solid;border-width:1px;" name="td_section_subtotalw" colspan="99">
										<strong class="mr16">Rs</strong>
										<span t-esc="doc.sale_order_id.currency_id.amount_to_text(current_subtotal)"/>
									</td>
								</tr>
							</t>
						</t>
					</tbody>
				</table>
				<p>
					<strong><h4>Terms &amp; Conditions:</h4></strong><br/>
					<span t-field="doc.sale_term"/>
				</p>
			</div>
		</t>
	</template>


	<template id="report_saleorder1">
		<t t-call="web.html_container">
			<t t-foreach="docs" t-as="doc">
				<t t-call="production_cost.report_saleorder_document11"
					t-lang="doc.partner_id.lang" />
			</t>
		</t>
	</template>

	<record id="action_report_saleorder11" model="ir.actions.report">
            <field name="name">OV DLR Proposal</field>
            <field name="model">sale.order.template</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">production_cost.report_saleorder1</field>
            <field name="report_file">production_cost.report_saleorder1</field>
            <field name="print_report_name">('OV DLR - %s' % (object.sale_order_id.name))</field>
            <field name="binding_model_id" ref="model_sale_order_template"/>
            <field name="binding_type">report</field>
        </record>

</odoo>
